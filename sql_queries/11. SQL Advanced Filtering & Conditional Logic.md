SQL provides various date and time functions that allow you to manipulate and format date and time values effectively. These functions are useful for handling everything from basic date arithmetic to time zone conversions.

Let’s break down key SQL date and time functions, along with examples.

1. Date Arithmetic
Date arithmetic involves adding or subtracting intervals (days, months, years, etc.) to/from dates or timestamps.

Adding/Subtracting Days to a Date
You can add or subtract days from a date using the + or - operator.

Example:

sql
Copy
Edit
SELECT CURRENT_DATE + INTERVAL '10' DAY AS future_date,
       CURRENT_DATE - INTERVAL '10' DAY AS past_date;
Explanation: This will give you the date 10 days from today (future_date) and 10 days ago (past_date).
Adding/Subtracting Months or Years
You can add or subtract months and years in a similar way.

Example:

sql
Copy
Edit
SELECT CURRENT_DATE + INTERVAL '2' MONTH AS two_months_later,
       CURRENT_DATE - INTERVAL '1' YEAR AS one_year_earlier;
Explanation: This adds 2 months to the current date and subtracts 1 year from it.
Date Difference (Days between Dates)
To find the difference between two dates in terms of days, you can subtract one date from another.

Example:

sql
Copy
Edit
SELECT CURRENT_DATE - '2024-01-01' AS days_diff;
Explanation: This returns the number of days between CURRENT_DATE and January 1, 2024.
2. Extracting Date Parts
SQL provides functions to extract specific parts (like the year, month, day, etc.) from a date or timestamp.

EXTRACT()
The EXTRACT() function allows you to pull specific parts (e.g., year, month, day, etc.) from a date or timestamp.

Example:

sql
Copy
Edit
SELECT EXTRACT(YEAR FROM CURRENT_DATE) AS year,
       EXTRACT(MONTH FROM CURRENT_DATE) AS month,
       EXTRACT(DAY FROM CURRENT_DATE) AS day;
Explanation: This will return the current year, month, and day.
DATE_PART()
The DATE_PART() function is similar to EXTRACT(), often used interchangeably in different databases (e.g., PostgreSQL uses DATE_PART()).

Example:

sql
Copy
Edit
SELECT DATE_PART('year', CURRENT_DATE) AS year,
       DATE_PART('month', CURRENT_DATE) AS month,
       DATE_PART('day', CURRENT_DATE) AS day;
Explanation: This returns the year, month, and day of the current date, similar to EXTRACT().
3. Converting & Formatting Dates
SQL provides functions to format dates into a string format and convert between different date types.

TO_DATE()
TO_DATE() is used to convert a string into a date format.

Example:

sql
Copy
Edit
SELECT TO_DATE('2024-12-25', 'YYYY-MM-DD') AS converted_date;
Explanation: This converts the string '2024-12-25' into a date in YYYY-MM-DD format.
TO_CHAR()
TO_CHAR() is used to format a date (or timestamp) into a string according to a specified format.

Example:

sql
Copy
Edit
SELECT TO_CHAR(CURRENT_DATE, 'DD/MM/YYYY') AS formatted_date;
Explanation: This will return the current date in DD/MM/YYYY format, like 10/02/2025.
DATE_FORMAT() (MySQL-specific)
MySQL offers DATE_FORMAT() for converting date values to a specific format.

Example:

sql
Copy
Edit
SELECT DATE_FORMAT(NOW(), '%Y-%m-%d %H:%i:%s') AS formatted_datetime;
Explanation: This will format the current date and time in the YYYY-MM-DD HH:MM:SS format.
4. Handling Time Zones
Handling time zones is important when dealing with applications across different geographic locations. SQL databases provide functions to manage and convert between time zones.

CURRENT_TIMESTAMP
CURRENT_TIMESTAMP returns the current date and time in the server's time zone.

Example:

sql
Copy
Edit
SELECT CURRENT_TIMESTAMP AS current_time;
Explanation: This returns the current date and time in the default time zone of the database server.
AT TIME ZONE
The AT TIME ZONE function (supported in PostgreSQL and other DBMSs) allows you to convert a timestamp from one time zone to another.

Example:

sql
Copy
Edit
SELECT CURRENT_TIMESTAMP AT TIME ZONE 'UTC' AS utc_time,
       CURRENT_TIMESTAMP AT TIME ZONE 'America/New_York' AS ny_time;
Explanation: This converts the current timestamp to UTC and New York time, respectively.
CONVERT_TZ() (MySQL-specific)
In MySQL, CONVERT_TZ() is used to convert a timestamp from one time zone to another.

Example:

sql
Copy
Edit
SELECT CONVERT_TZ(NOW(), 'UTC', 'America/Los_Angeles') AS la_time;
Explanation: This converts the current timestamp from UTC to Los Angeles time.
Summary of SQL Date & Time Functions
Function	Description	Example Query
DATE Arithmetic	Adding or subtracting days, months, years, etc. to/from a date.	SELECT CURRENT_DATE + INTERVAL '10' DAY;
EXTRACT()	Extracts specific parts (year, month, day, etc.) from a date.	SELECT EXTRACT(YEAR FROM CURRENT_DATE);
DATE_PART()	Extracts specific parts from a date (PostgreSQL).	SELECT DATE_PART('month', CURRENT_DATE);
TO_DATE()	Converts a string into a date.	SELECT TO_DATE('2024-12-25', 'YYYY-MM-DD');
TO_CHAR()	Formats a date into a string with a specific format.	SELECT TO_CHAR(CURRENT_DATE, 'DD/MM/YYYY');
DATE_FORMAT()	MySQL function to format date values.	SELECT DATE_FORMAT(NOW(), '%Y-%m-%d %H:%i:%s');
CURRENT_TIMESTAMP	Returns the current date and time in the server’s time zone.	SELECT CURRENT_TIMESTAMP;
AT TIME ZONE	Converts a timestamp to a specific time zone (PostgreSQL).	SELECT CURRENT_TIMESTAMP AT TIME ZONE 'UTC';
CONVERT_TZ()	Converts a timestamp from one time zone to another (MySQL).	SELECT CONVERT_TZ(NOW(), 'UTC', 'America/Los_Angeles');
Conclusion
SQL provides a wide array of functions for handling dates and times, including arithmetic, formatting, extracting date parts, and time zone conversions. These functions are crucial for working with date-related data, especially when dealing with time-sensitive applications or data stored across different time zones. By mastering these functions, you can perform complex date operations efficiently and with ease.



You said:
explain with examples SQL Advanced Filtering & Conditional Logic
CASE Statements
COALESCE & NULLIF
EXISTS & NOT EXISTS
Filtering with IN, ANY, ALL
ChatGPT said:
SQL provides advanced filtering and conditional logic features to handle complex data queries effectively. These include CASE statements, COALESCE, NULLIF, EXISTS, IN, and more. Let’s explore each of these concepts with examples.

1. CASE Statements
The CASE statement allows you to perform conditional logic in SQL. It works like an "if-else" statement in programming. You can use it to check conditions and return different values based on the result.

Basic Syntax
sql
Copy
Edit
CASE
    WHEN condition1 THEN result1
    WHEN condition2 THEN result2
    ELSE result3
END
Example:
Let’s say we have an employees table, and we want to categorize employees based on their salary into different ranges.

sql
Copy
Edit
SELECT employee_name,
       salary,
       CASE
           WHEN salary >= 100000 THEN 'High'
           WHEN salary BETWEEN 50000 AND 99999 THEN 'Medium'
           ELSE 'Low'
       END AS salary_category
FROM employees;
Explanation: This query checks the salary and assigns a category ('High', 'Medium', or 'Low') based on the value.
CASE with Aggregate Function:
sql
Copy
Edit
SELECT department_id,
       COUNT(CASE WHEN salary > 50000 THEN 1 END) AS high_earners
FROM employees
GROUP BY department_id;
Explanation: This counts how many employees in each department earn more than 50,000.
2. COALESCE & NULLIF
These functions are used to handle NULL values, which are often present in databases when data is missing or undefined.

COALESCE()
The COALESCE() function returns the first non-null value in a list of expressions.

Example:
sql
Copy
Edit
SELECT employee_name,
       COALESCE(phone_number, 'Not Provided') AS contact_info
FROM employees;
Explanation: If phone_number is NULL, the query returns 'Not Provided' instead.
NULLIF()
The NULLIF() function returns NULL if two expressions are equal; otherwise, it returns the first expression.

Example:
sql
Copy
Edit
SELECT employee_name,
       NULLIF(salary, 0) AS adjusted_salary
FROM employees;
Explanation: If salary is 0, it returns NULL. Otherwise, it returns the actual salary.
3. EXISTS & NOT EXISTS
The EXISTS and NOT EXISTS operators are used to test for the existence (or non-existence) of rows returned by a subquery.

EXISTS
The EXISTS operator checks whether a subquery returns any rows.

Example:
sql
Copy
Edit
SELECT department_name
FROM departments
WHERE EXISTS (SELECT 1 FROM employees WHERE employees.department_id = departments.department_id);
Explanation: This query returns the department names that have at least one employee. The subquery checks if there are employees in each department.
NOT EXISTS
The NOT EXISTS operator checks whether a subquery returns no rows.

Example:
sql
Copy
Edit
SELECT department_name
FROM departments
WHERE NOT EXISTS (SELECT 1 FROM employees WHERE employees.department_id = departments.department_id);
Explanation: This query returns the department names that have no employees.
4. Filtering with IN, ANY, ALL
SQL provides operators like IN, ANY, and ALL for more flexible filtering.

IN
The IN operator allows you to filter a column against a list of values.

Example:
sql
Copy
Edit
SELECT employee_name
FROM employees
WHERE department_id IN (1, 2, 3);
Explanation: This filters employees who belong to departments with IDs 1, 2, or 3.
ANY
The ANY operator is used with a comparison operator (like =, >, <, etc.) to compare a value to any value in a subquery or list.

Example:
sql
Copy
Edit
SELECT employee_name
FROM employees
WHERE salary > ANY (SELECT salary FROM employees WHERE department_id = 1);
Explanation: This query returns employees whose salary is greater than any salary in department 1. If there are salaries in department 1, the query will return employees with a higher salary.
ALL
The ALL operator is used to compare a value to all values in a subquery or list.

Example:
sql
Copy
Edit
SELECT employee_name
FROM employees
WHERE salary > ALL (SELECT salary FROM employees WHERE department_id = 1);
Explanation: This query returns employees whose salary is greater than all the salaries in department 1. If any salary in department 1 is greater or equal to the employee's salary, they won't be returned.
Summary of SQL Advanced Filtering & Conditional Logic
Function/Operator	Description	Example Query
CASE	Conditional logic, like "if-else" statements.	SELECT employee_name, CASE WHEN salary > 50000 THEN 'High' END FROM employees;
COALESCE()	Returns the first non-null value from a list of expressions.	SELECT COALESCE(phone_number, 'Not Provided') FROM employees;
NULLIF()	Returns NULL if two expressions are equal, otherwise returns the first expression.	SELECT NULLIF(salary, 0) FROM employees;
EXISTS	Checks if a subquery returns any rows.	SELECT department_name FROM departments WHERE EXISTS (SELECT 1 FROM employees WHERE employees.department_id = departments.department_id);
NOT EXISTS	Checks if a subquery returns no rows.	SELECT department_name FROM departments WHERE NOT EXISTS (SELECT 1 FROM employees WHERE employees.department_id = departments.department_id);
IN	Filters values against a list of possible values.	SELECT employee_name FROM employees WHERE department_id IN (1, 2, 3);
ANY	Compares a value against any value in a subquery or list.	SELECT employee_name FROM employees WHERE salary > ANY (SELECT salary FROM employees WHERE department_id = 1);
ALL	Compares a value against all values in a subquery or list.	SELECT employee_name FROM employees WHERE salary > ALL (SELECT salary FROM employees WHERE department_id = 1);
Conclusion
Advanced filtering and conditional logic in SQL enable you to create more dynamic and complex queries. The CASE statement allows for conditional logic, while COALESCE and NULLIF help you manage NULL values. Operators like EXISTS, IN, ANY, and ALL give you powerful ways to filter and compare data. Mastering these features will enhance your ability to write efficient and sophisticated SQL queries.
